(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-flavor-setting-add-flavor"],{4699:function(t,n,a){"use strict";a.r(n);var e=a("c8bd"),o=a.n(e);for(var i in e)"default"!==i&&function(t){a.d(n,t,function(){return e[t]})}(i);n["default"]=o.a},"7d65":function(t,n,a){"use strict";a.r(n);var e=a("9f58"),o=a("4699");for(var i in o)"default"!==i&&function(t){a.d(n,t,function(){return o[t]})}(i);var l,s=a("f0c5"),u=Object(s["a"])(o["default"],e["b"],e["c"],!1,null,null,null,!1,e["a"],l);n["default"]=u.exports},"9f58":function(t,n,a){"use strict";var e,o=function(){var t=this,n=t.$createElement,a=t._self._c||n;return a("v-uni-view",{staticClass:"page-wrap"},[a("v-uni-view",{staticClass:"page-content-title content-title"},[t._v(t._s(t.isUpdate?"UPDATE":"ADD")+" FLAVOR")]),a("v-uni-view",{staticClass:"page-content flex flex-column flex-between"},[a("v-uni-view",[t.flavorInfo.image[0].url?a("v-uni-image",{staticClass:"upload-avatar-wrap",attrs:{src:t.flavorInfo.image[0].url,mode:"aspectFill"}}):a("v-uni-view",{staticClass:"upload-avatar-wrap"}),a("uni-buttons",{staticClass:"mt20 mb20",on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.$openUpload()}}},[t._v("upload cover photo")]),a("uni-inputs",{attrs:{label:"* name",placeholder:"name",maxlength:30},model:{value:t.flavorInfo.name,callback:function(n){t.$set(t.flavorInfo,"name",n)},expression:"flavorInfo.name"}}),a("uni-inputs",{attrs:{label:"desp",placeholder:"description",maxlength:200},model:{value:t.flavorInfo.describe,callback:function(n){t.$set(t.flavorInfo,"describe",n)},expression:"flavorInfo.describe"}})],1),a("v-uni-view",{staticClass:"flex flex-end"},[a("uni-buttons",{attrs:{type:"gray",width:"9.8vw"},on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.back.apply(void 0,arguments)}}},[t._v("cancel")]),a("uni-buttons",{attrs:{width:"9.8vw"},on:{click:function(n){arguments[0]=n=t.$handleEvent(n),t.confirm.apply(void 0,arguments)}}},[t._v("save")])],1)],1),a("upload",{ref:"upload",attrs:{lists:[t.flavorInfo.image[0]]},on:{uploadOk:function(n){arguments[0]=n=t.$handleEvent(n),t.uploadPhoto.apply(void 0,arguments)}}}),a("uni-notify",{ref:"notify"})],1)},i=[];a.d(n,"b",function(){return o}),a.d(n,"c",function(){return i}),a.d(n,"a",function(){return e})},c8bd:function(t,n,a){"use strict";var e=a("288e");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=e(a("cebc")),i=e(a("5e7f")),l=a("2f62"),s={components:{upload:i.default},data:function(){return{flavorInfo:{name:"",describe:"",image:[{name:"",id:"",url:""}]},isUpdate:!1}},computed:(0,o.default)({},(0,l.mapState)(["shopFlavorEdit"])),onShow:function(){this.flavorInfo=(0,o.default)({},this.flavorInfo,this.shopFlavorEdit),this.isUpdate=!!this.flavorInfo.id},methods:(0,o.default)({},(0,l.mapActions)(["updateFlavor"]),{uploadPhoto:function(t){this.flavorInfo.image=[(0,o.default)({},t)]},validate:function(){return!(!this.flavorInfo.name||!this.flavorInfo.image[0].url)||(this.$notify({type:"error",title:"请添加图片和名称",button:[],callback:function(){console.log("error")}}),!1)},confirm:function(){this.isUpdate?this.update():this.save()},update:function(){var t=this;if(this.validate()){var n=this.flavorInfo,a={flavorId:n.id,data:{name:n.name,describe:n.describe,image:n.image}};this.updateFlavor(a).then(function(n){n?uni.showToast({icon:"none",title:"更新成功",success:function(n){var a=setTimeout(function(){t.back(),clearTimeout(a)},2e3)}}):uni.showToast({icon:"none",title:"更新失败，请稍后再试"})})}},save:function(){var t=this;this.validate()&&this.$postHttp(this.$API.addFlavor,(0,o.default)({},this.flavorInfo,{dataType:"json"})).then(function(n){1==n.status?uni.showToast({icon:"none",title:"添加成功",success:function(n){var a=setTimeout(function(){t.back(),clearTimeout(a)},2e3)}}):uni.showToast({icon:"none",title:"添加失败，请稍后再试"})})},back:function(){uni.navigateBack({delta:1})}})};n.default=s}}]);