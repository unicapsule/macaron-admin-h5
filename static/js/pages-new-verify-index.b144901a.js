(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-new-verify-index"],{"02ef":function(e,n,t){"use strict";var i,o=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("v-uni-view",{staticClass:"wrap"},[t("v-uni-view",{staticClass:"flex flex-between"},[t("v-uni-image",{staticClass:"logo",attrs:{src:e.logo}}),t("v-uni-text",[e._v(e._s(e.shopName))])],1),t("v-uni-view",{staticClass:"verify-wrap flex flex-column flex-center"},[t("v-uni-text",[e._v("hello "+e._s(e.shopInfo.username)+" welcome to "+e._s(e.shopName)+"\n                Before you get started, please enter your\n                verify code from "+e._s(e.verifyText))]),e.verifyInfo.needPhoneVerify?t("v-uni-view",{staticClass:"input-wrap"},[t("v-uni-input",{staticClass:"input",attrs:{placeholder:"phone verify code",type:"number",maxlength:"4"},model:{value:e.phoneCode,callback:function(n){e.phoneCode=n},expression:"phoneCode"}})],1):e._e(),e.verifyInfo.needEmailVerify?t("v-uni-view",{staticClass:"input-wrap"},[t("v-uni-input",{staticClass:"input",attrs:{placeholder:"email verify code",type:"number",maxlength:"4"},model:{value:e.emailCode,callback:function(n){e.emailCode=n},expression:"emailCode"}})],1):e._e(),t("v-uni-text",{staticClass:"btn btn-primary",on:{click:function(n){arguments[0]=n=e.$handleEvent(n),e.submitCode.apply(void 0,arguments)}}},[e._v("confirm")])],1)],1)},s=[];t.d(n,"b",function(){return o}),t.d(n,"c",function(){return s}),t.d(n,"a",function(){return i})},"08c3":function(e,n,t){"use strict";var i=t("288e");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=i(t("795b"));t("ac6a"),t("5df3");var s=i(t("cebc")),r=t("2f62"),a={data:function(){return{accountName:"guoqing",verifyText:"",phoneCode:"",emailCode:"",project:"macaron",isVerifySuccess:!0,promises:[]}},computed:(0,s.default)({},(0,r.mapState)(["verifyInfo"]),{shopName:function(){return uni.getStorageSync("shopName")},logo:function(){return uni.getStorageSync("logo")},shopInfo:function(){return uni.getStorageSync("shopInfo")}}),onLoad:function(){var e=this.verifyInfo;e.needEmailVerify&&(this.verifyText="email"),e.needPhoneVerify&&(this.verifyText="phone"),e.needEmailVerify&&query.needPhoneVerify&&(this.verifyText="phone and email")},onShow:function(){o.default.all(this.promises).then(function(e){console.log("all done")})},methods:{getPhoneCode:function(){var e=this,n=this.project,t=this.shopInfo;return new o.default(function(i){e.$postHttp(e.$API.getPhoneVerifyCode,{project:n,countryCode:t.countryCode,phone:t.phone,codeCount:4,dataType:"json"}).then(function(e){1==e.status?uni.showToast({icon:"none",title:"手机验证码已发送"}):uni.showToast({icon:"none",title:"手机验证码发送失败，请稍后重试"}),i()})})},getMailCode:function(){var e=this,n=this.project,t=this.shopInfo;return new o.default(function(i){e.$postHttp(e.$API.sendMailVerifyCode,{project:n,to:t.email,subject:"邮箱验证码",lang:"zh-CN",codeCount:4}).then(function(e){1==e.status?uni.showToast({icon:"none",title:"邮箱验证码已发送"}):uni.showToast({icon:"none",title:"邮箱验证码发送失败，请稍后重试"}),i()})})},verifyPhoneCode:function(){var e=this,n=this.phoneCode,t=this.project,i=this.shopInfo;return new o.default(function(o){e.$postHttp(e.$API.verifyPhoneCode,{project:t,code:n,phone:i.phone}).then(function(n){1!=n.status&&(e.isVerifySuccess=!1,uni.showToast({icon:"none",title:"手机验证码错误"})),o()}).catch(function(n){e.isVerifySuccess=!1,o()})})},verifyMailCode:function(){var e=this,n=this.emailCode,t=this.project,i=this.shopInfo;return new o.default(function(o){e.$postHttp(e.$API.verifyMailCode,{project:t,code:n,mail:i.email}).then(function(n){1!=n.status&&(e.isVerifySuccess=!1,uni.showToast({icon:"none",title:"邮箱验证码错误"})),o()}).catch(function(n){e.isVerifySuccess=!1,o()})})},validateCode:function(){if(this.phoneCode){if(this.emailCode)return!0;uni.showToast({icon:"none",title:"邮箱验证码不能为空"})}else uni.showToast({icon:"none",title:"手机验证码不能为空"})},updateAdminStatus:function(){this.$postHttp(this.$API.updateProfileStatus,{status:"pending"}).then(function(e){console.log("更改状态为pending"),uni.showToast({icon:"none",title:"验证码错误",success:function(e){var n=setTimeout(function(){clearTimeout(n),uni.removeStorageSync("token"),uni.removeStorageSync("shopInfo"),uni.redirectTo({url:"/pages/login/index"})},3e3)}})})},submitCode:function(){var e=this,n=this.verifyInfo,t=[];this.validateCode()&&(n.needVerifyPhone&&t.push(this.verifyPhoneCode()),n.needVerifyEmail&&t.push(this.verifyMailCode()),o.default.all(t).then(function(n){e.isVerifySuccess?(uni.removeStorageSync("isVerifyFail"),uni.redirectTo({url:"/pages/index/index"})):e.updateAdminStatus()}))}}};n.default=a},"1b77":function(e,n,t){"use strict";var i=t("87d5"),o=t.n(i);o.a},"5df3":function(e,n,t){"use strict";var i=t("02f4")(!0);t("01f9")(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,n=this._t,t=this._i;return t>=n.length?{value:void 0,done:!0}:(e=i(n,t),this._i+=e.length,{value:e,done:!1})})},"87d5":function(e,n,t){var i=t("88d2");"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var o=t("4f06").default;o("1471be5f",i,!0,{sourceMap:!1,shadowMode:!1})},"88d2":function(e,n,t){n=e.exports=t("2350")(!1),n.push([e.i,'@charset "UTF-8";\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\n/* 颜色变量 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */.verify-wrap[data-v-0331c46a]{padding:4vw;margin:4vw 0;border:1px solid #ddd;border-radius:1.3vw}',""])},bee8:function(e,n,t){"use strict";t.r(n);var i=t("02ef"),o=t("fc76");for(var s in o)"default"!==s&&function(e){t.d(n,e,function(){return o[e]})}(s);t("1b77");var r,a=t("f0c5"),u=Object(a["a"])(o["default"],i["b"],i["c"],!1,null,"0331c46a",null,!1,i["a"],r);n["default"]=u.exports},fc76:function(e,n,t){"use strict";t.r(n);var i=t("08c3"),o=t.n(i);for(var s in i)"default"!==s&&function(e){t.d(n,e,function(){return i[e]})}(s);n["default"]=o.a}}]);