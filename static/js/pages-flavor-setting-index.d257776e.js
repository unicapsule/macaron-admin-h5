(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-flavor-setting-index"],{"6f99":function(t,a,n){a=t.exports=n("2350")(!1),a.push([t.i,".upload-img-wrap[data-v-42acbadc],.upload-wrap[data-v-42acbadc]{width:26.7vw;height:20vw;line-height:20vw;text-align:center;background-color:#ddd;border-radius:10px}.upload-img-wrap[data-v-42acbadc]{background-color:#fff}.content-area[data-v-42acbadc]{margin-top:2.7vw}.content-info[data-v-42acbadc]{width:40vw}.radio-wrap[data-v-42acbadc]{margin-left:2vw;margin-top:1.3vw}.radio[data-v-42acbadc]{margin-right:1.3vw}.btn-wrap[data-v-42acbadc]{text-align:right;margin-top:20vw}",""])},"7a37":function(t,a,n){"use strict";n.r(a);var e=n("9b82"),i=n("fa3b");for(var o in i)"default"!==o&&function(t){n.d(a,t,function(){return i[t]})}(o);n("d51a");var s,u=n("f0c5"),r=Object(u["a"])(i["default"],e["b"],e["c"],!1,null,"42acbadc",null,!1,e["a"],s);a["default"]=r.exports},"7ca6":function(t,a,n){var e=n("6f99");"string"===typeof e&&(e=[[t.i,e,""]]),e.locals&&(t.exports=e.locals);var i=n("4f06").default;i("91de3376",e,!0,{sourceMap:!1,shadowMode:!1})},"9b82":function(t,a,n){"use strict";var e,i=function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("v-uni-view",{staticClass:"page-wrap"},[n("v-uni-view",{staticClass:"page-content-title  content-title"},[t._v("FLAVOR & GARNISH")]),n("v-uni-view",{staticClass:"page-content"},[n("v-uni-view",{staticClass:"flex flex-between"},[n("v-uni-view",[n("uni-buttons",{attrs:{group:t.buttonGroup},on:{change:function(a){arguments[0]=a=t.$handleEvent(a),t.radioChange.apply(void 0,arguments)}}})],1),n("v-uni-view",{staticClass:"flex"},[n("uni-buttons",{attrs:{"data-url":"/pages/flavor-setting/add-flavor"},on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.addNew.apply(void 0,arguments)}}},[t._v("Add new flavor")]),n("uni-buttons",{attrs:{"data-url":"/pages/flavor-setting/add-dish"},on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.addNew.apply(void 0,arguments)}}},[t._v("Add new dish")])],1)],1),n("uni-table",{attrs:{columns:t.infoMap[t.flag].columns,tableList:t.infoMap[t.flag].tableList},on:{handlerClick:function(a){arguments[0]=a=t.$handleEvent(a),t.doAction.apply(void 0,arguments)}}})],1),n("uni-notify",{ref:"notify"}),n("upload",{ref:"upload",on:{uploadOk:function(a){arguments[0]=a=t.$handleEvent(a),t.uploadOk.apply(void 0,arguments)}}}),n("page-popup",{ref:"pagePopup",attrs:{type:"confirm",title:"Are your sure to disable "+t.currentInfo.name,content:"Changes made to the symbols below will affect all text styles. \n        Remember to update your text styles before you make changes."},on:{cancel:function(a){arguments[0]=a=t.$handleEvent(a),t.$closePagePopup()},confirm:function(a){arguments[0]=a=t.$handleEvent(a),t.doDisable.apply(void 0,arguments)}}})],1)},o=[];n.d(a,"b",function(){return i}),n.d(a,"c",function(){return o}),n.d(a,"a",function(){return e})},d51a:function(t,a,n){"use strict";var e=n("7ca6"),i=n.n(e);i.a},f857:function(t,a,n){"use strict";var e=n("288e");Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=e(n("cebc")),o=e(n("5e7f")),s=e(n("797d")),u=e(n("ad50")),r=n("2f62"),l={components:{Upload:o.default,pagePopup:s.default,uniTable:u.default},data:function(){return{imageInfo:{flavor:{},dish:{}},infoMap:{flavor:{url:"/pages/flavor-setting/add-flavor",columns:[{name:"name",key:"name",iconKey:"image",column:3,sort:!0},{name:"status",key:"status",column:3,sort:!0},{name:"actions",key:"actions",column:1,handler:!0}],tableList:[]},dish:{url:"/pages/flavor-setting/add-dish",columns:[{name:"name",key:"name",iconKey:"image",sort:!0,column:2},{name:"status",key:"status",sort:!0},{name:"calorie",key:"calorie"},{name:"库存",key:"count",column:2},{name:"actions",key:"actions",handler:!0}],tableList:[]}},actions:{available:["Edit","Disable"],unavailable:["Edit","Enable"]},flavorList:[],dishList:[],flag:"flavor",buttonGroup:[{text:"调味",value:"flavor",handler:"change"},{text:"配菜",type:"gray",value:"dish",handler:"change"}],disableName:"",currentInfo:{},currentIndex:-1}},onShow:function(){this.initData()},methods:(0,i.default)({},(0,r.mapMutations)(["setShopFlavorEdit","setShopDishEdit"]),(0,r.mapActions)(["updateFlavor","updateShopGarnish"]),{initData:function(){this.imageInfo[this.flag]={},this.infoMap[this.flag].tableList=[],this.getFlavorList(),this.getShopGarnish(),this.setShopFlavorEdit({}),this.setShopDishEdit({})},uploadOk:function(t){console.log(t),this.imageInfo[this.flag]=t},radioChange:function(t){var a=t.currentTarget.dataset.value;this.flag=a,this.buttonGroup.map(function(t){t.value==a?t.type="primary":t.type="gray"})},getFlavorList:function(){var t=this;this.$getHttp(this.$API.getFlavorList,{},!1).then(function(a){1==a.status&&(t.flavorList=a.data,t.updateFlavorTableList(a.data))})},getShopGarnish:function(){var t=this;this.$getHttp(this.$API.getShopGarnish,{},!1).then(function(a){1==a.status&&(t.dishList=a.data,t.updateDishTableList(a.data))})},updateFlavorTableList:function(t){var a=this,n=[];t.map(function(t){n.push({name:t.name,image:t.image[0].url,status:t.status,actions:a.actions[t.status]})}),this.infoMap["flavor"].tableList=n},updateDishTableList:function(t){var a=this,n=[];t.map(function(t){n.push({name:t.name,image:t.image[0].url,count:t.count,calorie:t.calorie,status:t.status,actions:a.actions[t.status]})}),this.infoMap["dish"].tableList=n},doAction:function(t,a){var n="";switch(this.currentIndex=t,"flavor"==this.flag?(this.currentInfo=this.flavorList[t],n="setShopFlavorEdit"):(this.currentInfo=this.dishList[t],n="setShopDishEdit"),a){case"Edit":this[n](this.currentInfo),this.navTo(this.infoMap[this.flag].url);break;case"Disable":this.$openPagePopup();break;case"Enable":this.doEnable();break;default:break}},update:function(t){var a=this;"flavor"==this.flag?this.updateFlavor(t).then(function(n){n?uni.showToast({icon:"none",title:"更新成功",success:function(n){a.flavorList[a.currentIndex].status=t.data.status,a.updateFlavorTableList(a.flavorList)}}):uni.showToast({icon:"none",title:"更新失败，请稍后再试"})}):this.updateShopGarnish(t).then(function(n){n?uni.showToast({icon:"none",title:"更新成功",success:function(n){a.dishList[a.currentIndex].status=t.data.status,a.updateDishTableList(a.dishList)}}):uni.showToast({icon:"none",title:"更新失败，请稍后再试"})})},doEnable:function(){var t={data:{status:"available"}};"flavor"==this.flag?(t.flavorId=this.currentInfo.id,this.update(t)):(t.garnishId=this.currentInfo.id,this.update(t))},doDisable:function(){var t={data:{status:"unavailable"}};"flavor"==this.flag?(t.flavorId=this.currentInfo.id,this.update(t)):(t.garnishId=this.currentInfo.id,this.update(t)),this.$closePagePopup()},addNew:function(t){var a=t.currentTarget.dataset.url;this.navTo(a)},navTo:function(t){t&&uni.navigateTo({url:t})}})};a.default=l},fa3b:function(t,a,n){"use strict";n.r(a);var e=n("f857"),i=n.n(e);for(var o in e)"default"!==o&&function(t){n.d(a,t,function(){return e[t]})}(o);a["default"]=i.a}}]);