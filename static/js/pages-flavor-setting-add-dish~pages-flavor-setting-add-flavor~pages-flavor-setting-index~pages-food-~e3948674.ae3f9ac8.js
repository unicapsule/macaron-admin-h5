(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-flavor-setting-add-dish~pages-flavor-setting-add-flavor~pages-flavor-setting-index~pages-food-~e3948674"],{"0b64":function(t,e,i){var n=i("f772"),a=i("9003"),s=i("5168")("species");t.exports=function(t){var e;return a(t)&&(e=t.constructor,"function"!=typeof e||e!==Array&&!a(e.prototype)||(e=void 0),n(e)&&(e=e[s],null===e&&(e=void 0))),void 0===e?Array:e}},"22d2":function(t,e,i){"use strict";var n=i("936b"),a=i.n(n);a.a},"2d7d":function(t,e,i){t.exports=i("5037")},4517:function(t,e,i){var n=i("a22a");t.exports=function(t,e){var i=[];return n(t,!1,i.push,i,e),i}},5037:function(t,e,i){i("c207"),i("1654"),i("6c1c"),i("837d"),i("5cb6"),i("fe1e"),i("7554"),t.exports=i("584a").Map},"57b1":function(t,e,i){var n=i("d864"),a=i("335c"),s=i("241e"),o=i("b447"),r=i("bfac");t.exports=function(t,e){var i=1==t,c=2==t,u=3==t,l=4==t,d=6==t,f=5==t||d,p=e||r;return function(e,r,h){for(var v,m,g=s(e),b=a(g),w=n(r,h,3),y=o(b.length),x=0,_=i?p(e,y):c?p(e,0):void 0;y>x;x++)if((f||x in b)&&(v=b[x],m=w(v,x,g),t))if(i)_[x]=m;else if(m)switch(t){case 3:return!0;case 5:return v;case 6:return x;case 2:_.push(v)}else if(l)return!1;return d?-1:u||l?l:_}}},"5aee":function(t,e,i){"use strict";var n=i("d9f6").f,a=i("a159"),s=i("5c95"),o=i("d864"),r=i("1173"),c=i("a22a"),u=i("30f1"),l=i("50ed"),d=i("4c95"),f=i("8e60"),p=i("ebfd").fastKey,h=i("9f79"),v=f?"_s":"size",m=function(t,e){var i,n=p(e);if("F"!==n)return t._i[n];for(i=t._f;i;i=i.n)if(i.k==e)return i};t.exports={getConstructor:function(t,e,i,u){var l=t(function(t,n){r(t,l,e,"_i"),t._t=e,t._i=a(null),t._f=void 0,t._l=void 0,t[v]=0,void 0!=n&&c(n,i,t[u],t)});return s(l.prototype,{clear:function(){for(var t=h(this,e),i=t._i,n=t._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete i[n.i];t._f=t._l=void 0,t[v]=0},delete:function(t){var i=h(this,e),n=m(i,t);if(n){var a=n.n,s=n.p;delete i._i[n.i],n.r=!0,s&&(s.n=a),a&&(a.p=s),i._f==n&&(i._f=a),i._l==n&&(i._l=s),i[v]--}return!!n},forEach:function(t){h(this,e);var i,n=o(t,arguments.length>1?arguments[1]:void 0,3);while(i=i?i.n:this._f){n(i.v,i.k,this);while(i&&i.r)i=i.p}},has:function(t){return!!m(h(this,e),t)}}),f&&n(l.prototype,"size",{get:function(){return h(this,e)[v]}}),l},def:function(t,e,i){var n,a,s=m(t,e);return s?s.v=i:(t._l=s={i:a=p(e,!0),k:e,v:i,p:n=t._l,n:void 0,r:!1},t._f||(t._f=s),n&&(n.n=s),t[v]++,"F"!==a&&(t._i[a]=s)),t},getEntry:m,setStrong:function(t,e,i){u(t,e,function(t,i){this._t=h(t,e),this._k=i,this._l=void 0},function(){var t=this,e=t._k,i=t._l;while(i&&i.r)i=i.p;return t._t&&(t._l=i=i?i.n:t._t._f)?l(0,"keys"==e?i.k:"values"==e?i.v:[i.k,i.v]):(t._t=void 0,l(1))},i?"entries":"values",!i,!0),d(e)}}},"5cb6":function(t,e,i){var n=i("63b6");n(n.P+n.R,"Map",{toJSON:i("f228")("Map")})},"5e7f":function(t,e,i){"use strict";i.r(e);var n=i("66a5"),a=i("e54e");for(var s in a)"default"!==s&&function(t){i.d(e,t,function(){return a[t]})}(s);i("22d2");var o,r=i("f0c5"),c=Object(r["a"])(a["default"],n["b"],n["c"],!1,null,"92cc0ada",null,!1,n["a"],o);e["default"]=c.exports},"66a5":function(t,e,i){"use strict";var n,a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",[i("uni-popup",{ref:"uppopup",attrs:{type:"center",maskClick:!1}},[i("v-uni-view",{staticClass:"popup-wrap upload-popup",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.resetIndex.apply(void 0,arguments)}}},[i("v-uni-text",{staticClass:"mr10"},[t._v("从店铺图片相册中选择")]),t.selectNumList.length?i("v-uni-text",[t._v("已选择"+t._s(t.selectNumList.length)+"张")]):t._e(),i("v-uni-view",{staticClass:"flex flex-between image-wrap"},[i("v-uni-view",{staticClass:"image-list-wrap"},[t._l(t.imageRecord,function(e,n){return["available"==e.status?i("v-uni-view",{key:n+"_0",staticClass:"image-list-item",attrs:{"data-index":n},on:{touchstart:function(e){arguments[0]=e=t.$handleEvent(e),t.touchStart.apply(void 0,arguments)},touchend:function(e){arguments[0]=e=t.$handleEvent(e),t.touchEnd.apply(void 0,arguments)},longpress:function(e){arguments[0]=e=t.$handleEvent(e),t.longpress.apply(void 0,arguments)}}},[i("v-uni-image",{staticClass:"image",class:e.className,attrs:{src:e.imageUrl,mode:"aspectFill"},on:{touchstart:function(e){e.preventDefault(),arguments[0]=e=t.$handleEvent(e)},touchend:function(e){e.preventDefault(),arguments[0]=e=t.$handleEvent(e)}}}),t.deleteIndex==n?i("v-uni-view",{staticClass:"delete-item",attrs:{"data-index":n},on:{touchend:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e)},click:function(e){arguments[0]=e=t.$handleEvent(e),t.deleteRecord.apply(void 0,arguments)}}},[i("uni-icons",{attrs:{type:"trash",size:"20",color:"#000000"}}),i("v-uni-text",[t._v("Delete from history")])],1):t._e()],1):t._e()]}),t.imageRecord.length%3!=0?t._l(t.outerList,function(t,e){return i("v-uni-view",{key:e,staticClass:"transparent"})}):t._e()],2),i("v-uni-view",{staticClass:"upload-button-wrap"},[i("v-uni-view",[i("uni-buttons",{staticClass:"upload-album-button",attrs:{size:"big"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.chooseImage("album")}}},[t._v("从系统相册选取图片")]),i("uni-buttons",{attrs:{size:"big"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.chooseImage("camera")}}},[t._v("拍摄新照片")])],1),i("v-uni-view",{staticClass:"flex flex-end width100"},[i("uni-buttons",{staticClass:"mr10 mb0",attrs:{size:"small",width:"9.8vw",type:"gray"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.closeUpload.apply(void 0,arguments)}}},[t._v("cancel")]),i("uni-buttons",{staticClass:"mb0",attrs:{size:"small",width:"9.8vw"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.uploadOk.apply(void 0,arguments)}}},[t._v("confirm")])],1)],1)],1)],1)],1),i("uni-notify",{ref:"notify"})],1)},s=[];i.d(e,"b",function(){return a}),i.d(e,"c",function(){return s}),i.d(e,"a",function(){return n})},"68f7":function(t,e,i){"use strict";var n=i("63b6"),a=i("79aa"),s=i("d864"),o=i("a22a");t.exports=function(t){n(n.S,t,{from:function(t){var e,i,n,r,c=arguments[1];return a(this),e=void 0!==c,e&&a(c),void 0==t?new this:(i=[],e?(n=0,r=s(c,arguments[2],2),o(t,!1,function(t){i.push(r(t,n++))})):o(t,!1,i.push,i),new this(i))}})}},"6db0":function(t,e,i){e=t.exports=i("2350")(!1),e.push([t.i,'@charset "UTF-8";\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\n/* 颜色变量 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */.uni-upload-wrap[data-v-92cc0ada]{width:-webkit-max-content;width:max-content}.upload-popup[data-v-92cc0ada]{padding:4.4vw}.image-wrap[data-v-92cc0ada]{height:-webkit-max-content;height:max-content}.image-list-wrap[data-v-92cc0ada]{width:48vw;min-height:40vw;max-height:60.5vw;margin-right:8.5vw;padding:0 1vw;overflow-y:scroll;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-justify-content:space-around;justify-content:space-around;-webkit-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-align:start;-webkit-align-items:flex-start;align-items:flex-start}.image-list-wrap .transparent[data-v-92cc0ada]{width:13.2vw;border:1px solid transparent}.image-list-item[data-v-92cc0ada]{margin:2vw 2vw 0 0;position:relative;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center}.image-list-item[data-v-92cc0ada]:nth-child(3n){margin-right:0}.image-list-item .image[data-v-92cc0ada]{width:13.2vw;height:13.2vw;border:1px solid #979797;box-sizing:border-box}.image-list-item .image.active[data-v-92cc0ada]{border:4px solid #3cba92}.image-list-item .delete-item[data-v-92cc0ada]{position:absolute;background-color:#fff;border:1px solid #e4e4e4;padding:1vw 0;border-radius:.5vw;min-width:16.3vw;text-align:center;bottom:-2.3vw;font-size:1.3vw;z-index:1000}.upload-button-wrap[data-v-92cc0ada]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between}.upload-album-button[data-v-92cc0ada]{margin-bottom:2vw}.mr10[data-v-92cc0ada]{margin-right:2.9vw}.mb0[data-v-92cc0ada]{margin-bottom:0}',""])},7075:function(t,e,i){"use strict";var n=i("63b6");t.exports=function(t){n(n.S,t,{of:function(){var t=arguments.length,e=new Array(t);while(t--)e[t]=arguments[t];return new this(e)}})}},7554:function(t,e,i){i("68f7")("Map")},"837d":function(t,e,i){"use strict";var n=i("5aee"),a=i("9f79"),s="Map";t.exports=i("ada4")(s,function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},{get:function(t){var e=n.getEntry(a(this,s),t);return e&&e.v},set:function(t,e){return n.def(a(this,s),0===t?0:t,e)}},n,!0)},"936b":function(t,e,i){var n=i("6db0");"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var a=i("4f06").default;a("2b070fa8",n,!0,{sourceMap:!1,shadowMode:!1})},"9f79":function(t,e,i){var n=i("f772");t.exports=function(t,e){if(!n(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},ada4:function(t,e,i){"use strict";var n=i("e53d"),a=i("63b6"),s=i("ebfd"),o=i("294c"),r=i("35e8"),c=i("5c95"),u=i("a22a"),l=i("1173"),d=i("f772"),f=i("45f2"),p=i("d9f6").f,h=i("57b1")(0),v=i("8e60");t.exports=function(t,e,i,m,g,b){var w=n[t],y=w,x=g?"set":"add",_=y&&y.prototype,k={};return v&&"function"==typeof y&&(b||_.forEach&&!o(function(){(new y).entries().next()}))?(y=e(function(e,i){l(e,y,t,"_c"),e._c=new w,void 0!=i&&u(i,g,e[x],e)}),h("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(t){var e="add"==t||"set"==t;t in _&&(!b||"clear"!=t)&&r(y.prototype,t,function(i,n){if(l(this,y,t),!e&&b&&!d(i))return"get"==t&&void 0;var a=this._c[t](0===i?0:i,n);return e?this:a})}),b||p(y.prototype,"size",{get:function(){return this._c.size}})):(y=m.getConstructor(e,t,g,x),c(y.prototype,i),s.NEED=!0),f(y,t),k[t]=y,a(a.G+a.W+a.F,k),b||m.setStrong(y,t,g),y}},b06b:function(t,e,i){"use strict";var n=i("288e");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=n(i("cebc"));i("4917");var s=n(i("2d7d")),o=n(i("774e")),r=n(i("f499"));i("c5f6");var c=n(i("ae08")),u={components:{uniPopup:c.default},data:function(){return{sourceType:"album",imageList:[],uploadLength:1,imageRecord:[],outerList:[],selectNumList:[],deleteIndex:-1,idMap:{},startTime:"",endTime:""}},props:{lists:{type:Array,default:function(){return[]}},originImages:{type:Array,default:function(){return[]}},count:{type:Number,default:1},sizeType:{type:Array,default:function(){return["compress"]}},fileType:{type:String,default:"oss.com/avatar"},authorId:{type:String,default:""}},methods:{openUpload:function(){this.$refs.uppopup.open(),this.getShopImage()},closeUpload:function(){this.$refs.uppopup.close()},getShopImage:function(){var t=this;this.selectNumList=[],this.deleteIndex=-1,this.$getHttp(this.$API.getImageRecord,{},!1).then(function(e){if(1==e.status){if(t.imageRecord=e.data.map(function(t){return t.className="",t}),t.lists.length){var i=JSON.parse((0,r.default)(t.imageRecord)),n=[],a=[],s=[];t.lists.map(function(t){i.map(function(e,i){t.url==e.imageUrl&&(e.className="active",n.push(e),s.push(i))})}),i.map(function(t,e){-1==s.indexOf(e)&&(t.className="",a.push(t))}),t.imageRecord=[].concat(n,a),t.lists.map(function(e){t.imageRecord.map(function(i,n){e.url==i.imageUrl&&t.selectNumList.push(+n)})})}t.outerList=(0,o.default)(new Array(t.imageRecord.length%3,1))}})},unique:function(t){var e=new s.default;return t.filter(function(t){return!e.has(t.url)&&e.set(t.url,1)})},resetIndex:function(t){this.deleteIndex=-1},touchStart:function(){this.startTime=+new Date},touchEnd:function(t){this.endTime=+new Date,this.endTime-this.startTime<350&&this.selectImage(t)},longpress:function(t){this.deleteIndex=t.currentTarget.dataset.index},selectImage:function(t){var e=t.currentTarget.dataset.index,i=this.selectNumList.indexOf(+e);if(-1==i){if(1==this.count&&1==this.selectNumList.length)return this.imageRecord.map(function(t){t.className=""}),this.imageRecord[e].className="active",void(this.selectNumList=[+e]);this.selectNumList.length>this.count?this.$notify({type:"warning",title:"最多可选择".concat(this.count,"张图片"),timeout:3e3}):(this.selectNumList.push(+e),this.imageRecord[e].className="active")}else this.selectNumList.splice(i,1),this.imageRecord[e].className=""},chooseImage:function(t){this.upload(t)},uploadOk:function(){var t=this.selectNumList,e=this.imageRecord,i=[],n=[];this.count>1?(t.map(function(t){i.push({url:e[t].imageUrl,name:e[t].imageUrl.match("[^/]+(?!.*/)")[0],id:e[t].imageId}),n.push(e[t].imageUrl)}),this.originImages.map(function(t){-1==n.indexOf(t.url)&&i.push(t)}),this.closeUpload(),this.$emit("uploadOk",i)):(this.closeUpload(),t.length?this.$emit("uploadOk",{url:e[t[0]].imageUrl,name:e[t[0]].imageUrl.match("[^/]+(?!.*/)")[0],id:e[t[0]].imageId}):this.$emit("uploadOk",(0,a.default)({},this.originImages[0])))},upload:function(t){var e=this,i=this.count,n=(this.sizeType,this.fileType),a=(this.authorId,this);uni.chooseImage({count:i,sizeType:["compressed"],sourceType:["album"],success:function(t){var i=t.tempFilePaths;e.uploadLength=i.length,i.map(function(t){var i=t,s=i.lastIndexOf("/"),o=i.substr(s+1);-1==o.indexOf(".")&&(o+=".png"),e.$postHttp(e.$API.getPolicy,{fileName:o,maxSize:10485760,filePath:"macaron",fileType:n,dataType:"json"},!1).then(function(t){var n=e.$notify({type:"success",title:"Uploading",content:"".concat(o," is uploading: 0%"),button:[{theme:"border",text:"cancel",callback:function(){a.idMap[t.id].uploadTask.abort(),a.$notifyClose(n),console.log("abort")},close:!0}]});e.post(t,i,n)})})}})},post:function(t,e,i){var n=this;this.idMap[t.id]={},this.idMap[t.id].uuid=i,this.idMap[t.id].uploadTask=uni.uploadFile({url:t.ossHost,name:"file",filePath:e,formData:{ossAccessKeyId:t.ossAccessKeyId,policy:t.policy,signature:t.signature,key:t.key,success_action_status:"200",fileType:t.fileType},success:function(e){n.save(t.id),n.addRecord({imageId:t.id,imageUrl:t.url});var i={url:t.url,id:t.id,name:t.fileName};n.imageList.push(i)},fail:function(e){n.$notifyClose(i),n.$notify({type:"error",title:"Upload failed, please try again",content:"".concat(t.fileName," upload failed, please try again later"),timeout:2e3})}});var a=function(e){n.idMap[e].uploadTask.onProgressUpdate(function(i){if(n.$notifyUpdate({uuid:n.idMap[e].uuid,content:"".concat(t.fileName," is uploading: ").concat(i.progress,"%")}),100==i.progress)var a=setTimeout(function(){n.$notifyClose(n.idMap[e].uuid),clearTimeout(a)},1e3)})};for(var s in this.idMap)a(s)},save:function(t){this.$postHttp(this.$API.saveFileToDb,{id:t,dataType:"json"},!1).then(function(t){console.log(t)})},addRecord:function(t){var e=this,i=t.imageId,n=t.imageUrl;i&&this.$postHttp(this.$API.addImageRecord,{imageId:i,imageUrl:n}).then(function(t){1==t.status&&e.getShopImage()})},deleteRecord:function(t){var e=this,i=t.currentTarget.dataset.index,n=this.imageRecord[i].imageId;this.$postHttp(this.$API.updateImageRecord,{imageId:n,status:"unavailable"}).then(function(t){1==t.status&&e.imageRecord.splice(i,1)})}}};e.default=u},bfac:function(t,e,i){var n=i("0b64");t.exports=function(t,e){return new(n(t))(e)}},e54e:function(t,e,i){"use strict";i.r(e);var n=i("b06b"),a=i.n(n);for(var s in n)"default"!==s&&function(t){i.d(e,t,function(){return n[t]})}(s);e["default"]=a.a},f228:function(t,e,i){var n=i("40c3"),a=i("4517");t.exports=function(t){return function(){if(n(this)!=t)throw TypeError(t+"#toJSON isn't generic");return a(this)}}},fe1e:function(t,e,i){i("7075")("Map")}}]);